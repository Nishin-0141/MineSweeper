# DynamoDB テーブル設計書

## 概要
本設計では、ユーザー登録機能およびスコアランキング機能を持つ  
マインスイーパーゲーム向けの DynamoDB テーブル構成を定義する。

構成は以下の2テーブル + 1 GSI。

- Users テーブル（ユーザー管理）
- Scores テーブル（スコア管理）
- GSI（TimeIndex：ランキング用）

---

# 1. Users テーブル

ユーザー情報を保存するテーブル。  
ユーザー登録（SignUp）・ログイン（Login）で使用。

## テーブル名
```
Users
```

## キー構成

| 名称      | 型     | 役割        |
|-----------|--------|-------------|
| UserId    | String | パーティションキー（PK） |

## 属性一覧

| 属性名        | 型     | 説明 |
|---------------|--------|------|
| UserId        | String | 一意のユーザーID（UUID） |
| Email         | String | メールアドレス（任意） |
| PasswordHash  | String | ハッシュ化済パスワード |
| DisplayName   | String | 表示名 |
| CreatedAt     | String | 作成日時（ISO8601） |
| UpdatedAt     | String | 更新日時（ISO8601） |

---

# 2. Scores テーブル

ユーザーのゲーム結果（クリアタイム）を保存するテーブル。

## テーブル名
```
Scores
```

## キー構成

| 名称      | 型     | 役割        |
|-----------|--------|-------------|
| UserId    | String | パーティションキー（PK） |
| Timestamp | Number | ソートキー（SK） |

同一ユーザーのスコア履歴を時系列で管理できる。

## 属性一覧

| 属性名      | 型     | 説明 |
|-------------|--------|------|
| UserId      | String | ユーザーID |
| Timestamp   | Number | 記録保存時刻（UNIX time） |
| Time        | Number | クリアタイム（秒） |
| Level       | String | 難易度（easy / normal / hard） |
| CreatedAt   | String | 保存日時（ISO8601） |

---

# 3. GSI（ランキング取得用）

クリアタイムの速い順（昇順）でランキングを取得するためのインデックス。

## GSI 名
```
TimeIndex
```

## キー構成

| 名称  | 型     | 役割                         |
|-------|--------|------------------------------|
| Level | String | パーティションキー（難易度） |
| Time  | Number | ソートキー（クリアタイム）   |

## 使い方（例）

```
Query TimeIndex
WHERE Level = "easy"
ORDER BY Time ASC
LIMIT 100
```

難易度ごとの最速プレイヤーランキングを高速に取得可能。

---

# 4. ER 図（簡易）

```
Users (1) ──── (N) Scores
```

---

# 5. 全体構成図

```
Users Table
│
├── UserId (PK)
└── Email, PasswordHash, DisplayName ...

Scores Table
│
├── UserId (PK)
├── Timestamp (SK)
├── Time
├── Level
└── CreatedAt

GSI: TimeIndex
  ├── Level (PK)
  └── Time (SK)
```

---

# 6. 備考

- ユーザーごとのスコア履歴管理と、世界ランキングの両立を想定。
- 2テーブル構成は拡張性・メンテナンス性に優れる。

以上。
